<!--  This file is part of the research.fi API service
 Copyright 2019 Ministry of Education and Culture, Finland
 :author: CSC - IT Center for Science Ltd., Espoo Finland servicedesk@csc.fi
 :license: MIT -->

<div class="row" *ngIf="data">
  <div class="col py-3 px-0">
    <ng-container *ngFor="let field of data.fields; let i = index">
      <div class="row field">
        <div class="col px-0">
          <!-- Field -->
          <div class="row">
            <span class="col px-0 h6 field-label">
              {{ field.label }}
            </span>

            <div class="col-auto">
              <mat-slide-toggle
                [checked]="field.groupMeta.show"
                (change)="toggleField(i)"
                labelPosition="before"
                >Näytä profiilissani</mat-slide-toggle
              >
            </div>
          </div>

          <!-- Field values -->
          <div
            class="row"
            *ngIf="field.items.length === 1; else fieldArrayTemplate"
          >
            <div class="col field-value">
              {{ field.items[0].value }}

              <span class="pl-3 opacity-3">
                {{ field.dataSource.name }}
              </span>
            </div>
          </div>
          <ng-template #fieldArrayTemplate>
            <div class="col field-value" *ngFor="let value of field.items">
              <!-- TODO: Map group type id to human readable label -->
              <ng-container [ngSwitch]="field.groupMeta.type">
                <ng-container *ngSwitchCase="110">{{ value.url }}</ng-container>
              </ng-container>

              <span class="pl-3 opacity-3">
                {{ field.dataSource.name }}
              </span>
            </div>
          </ng-template>
        </div>
      </div>
    </ng-container>

    <div class="row pt-3">
      <span class="col-12">Valitse lähteet:</span>
      <app-button-group
        class="col-12 pb-3"
        [data]="dataSources"
        [checked]="checked"
        [vertical]="appSettingsService.mobileStatus | async"
      ></app-button-group>
    </div>
  </div>
</div>
