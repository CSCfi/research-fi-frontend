<!--  This file is part of the research.fi API service
 Copyright 2019 Ministry of Education and Culture, Finland
 :author: CSC - IT Center for Science Ltd., Espoo Finland servicedesk@csc.fi
 :license: MIT -->

<div class="row" *ngIf="data">
  <div class="col pt-3 pb-4 px-0">
    <ng-container *ngFor="let field of data.fields; let i = index">
      <div class="row pt-3 pb-4">
        <div class="col px-0">
          <!-- Field -->
          <div class="row">
            <span class="col px-0 h6 m-0 pb-4 field-label">
              {{ field.label }}
            </span>

            <div class="col-auto pr-0" *ngIf="!field.disabled">
              <mat-slide-toggle
                [checked]="field.groupMeta.show"
                (change)="toggleField(i)"
                [disabled]="field.disabled"
                labelPosition="after"
                >Näytä profiilissani</mat-slide-toggle
              >
            </div>
          </div>

          <!-- Field values -->
          <div
            class="row field-value d-flex justify-content-between"
            *ngIf="field.items.length === 1; else fieldArrayTemplate"
          >
            <div class="col-auto font-size-smaller">
              {{ field.items[0].value }}
            </div>

            <div class="col-auto pr-0 text-right opacity-3 font-size-small">
              {{ field.dataSource.name }}
            </div>
          </div>
          <ng-template #fieldArrayTemplate>
            <div
              class="row field-value d-flex justify-content-between"
              *ngFor="let value of field.items"
            >
              <div
                [ngSwitch]="field.groupMeta.type"
                class="col-auto font-size-smaller"
              >
                <ng-container *ngSwitchCase="fieldTypes.webLink">{{
                  value.url
                }}</ng-container>
                <ng-container *ngSwitchDefault>
                  {{ value.value }}
                </ng-container>
              </div>

              <div class="col-auto pr-0 text-right opacity-3 font-size-small">
                {{ field.dataSource.name }}
              </div>
            </div>
          </ng-template>
        </div>
      </div>

      <div class="row" *ngIf="!field.disabled">
        <span class="col-12 px-lg-0 pb-2 font-size-small"
          >Valitse lähteet:</span
        >
        <app-button-group
          class="col-12 pb-2 px-lg-0"
          [data]="dataSources"
          [multiple]="true"
          [checked]="checked"
          [vertical]="appSettingsService.mobileStatus | async"
        ></app-button-group>
      </div>

      <div class="row pb-4 font-size-small" *ngIf="!field.disabled">
        <div class="col col-lg-6 pl-0">
          <fa-icon class="pr-1 opacity-3" icon="info-circle"></fa-icon>
          <span>Voit valita useamman lähteen</span>
        </div>
        <div class="col pr-0 opacity-3"><span>1 lähde valittu</span></div>
      </div>

      <hr class="m-0" />
    </ng-container>
  </div>
</div>
