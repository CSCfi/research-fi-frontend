<!--  This file is part of the research.fi API service
 Copyright 2019 Ministry of Education and Culture, Finland
 :author: CSC - IT Center for Science Ltd., Espoo Finland servicedesk@csc.fi
 :license: MIT -->

<app-welcome-dialog *ngIf="showWelcomeDialog"></app-welcome-dialog>

<app-banner-divider></app-banner-divider>


<main id="main-content" class="tt-main-content pt-0">
  <div class="wrapper tt-wrapper">
    <!-- Groups -->
    <div class="row justify-content-between">
      <!-- Side navigation pad -->
      <div class="col-4 col-md-2 pt-4 px-0 side-navigation-side-border d-none d-xl-block">
        <app-mydata-side-navigation></app-mydata-side-navigation>
      </div>
      <!-- Main content -->
      <div class="col-xl-10 col-md-12 pt-4 gx-0 gx-md-4">
        <!--        <div class="row d-flex justify-content-between pt-3 pb-5">
                  <div class="col-6 col-md-6">
                    <div class="row d-flex text-capitalize" *ngIf="profileService.currentEditorProfileName | async">
                      <h1 class="col-12">
                        {{ profileService.currentEditorProfileName | async }}
                      </h1>
                      <div class="col align-self-center">
                        <img class="orcid-icon mt-n1 pe-2" src="assets/img/orcid_icon.svg" alt="Orcid -palvelun logo"/>
                        <span>{{ orcid }}</span>
                      </div>
                    </div>
                  </div>

                  <div class="col d-flex justify-content-end">
                    <ng-container *ngIf="false">
                    &lt;!&ndash; TODO: add luonnos text here. Check from draft service &ndash;&gt;
                    </ng-container>
                  </div>

                  &lt;!&ndash; <div class="col-5 d-none d-md-block px-lg-0">
                    <div class="row justify-content-end align-items-center">
                      <div class="col-auto profile-image-container opacity-3">
                        <i class="fas fa-user text-center d-block h1"></i>
                      </div>
                      <a disabled class="col-auto px-0 disabled"
                        >+
                        <ng-container i18n="@@addPublicProfilePicture"
                          >Lisää Julkinen profiilikuva</ng-container
                        ></a
                      >
                    </div>
                  </div> &ndash;&gt;
                </div>

                &lt;!&ndash; Contact card in mobile view &ndash;&gt;
                <aside *ngIf="profileData" class="profile-card d-block d-lg-none">
                  <div class="card-content-wrapper">
                  <app-contact-card
                          i18n-label="@@contactInfo"
                          label="Yhteystiedot"
                          [data]="profileData"
                  ></app-contact-card>
                  </div>
                </aside>-->

        <!-- Left side fields for profile data -->
        <div class="row">
          <ng-container *ngIf="profileData; else loadingTemplate">
            <div class="col-12">
              <app-name-and-orcid-view [name]="fullName | async" [orcid]="orcid"
                                       [isEditorView]="true"></app-name-and-orcid-view>
            </div>
            <div *ngIf="(this.profileService.automaticPublishingInitialState$ | async) !== true">
              <app-general-info-banner class="gx-0 gx-md-4 my-3"
                                       [bannerContent]="automaticPublishingBannerContent"></app-general-info-banner>
            </div>
            <div class="col-12 col-md-7 col-lg-8 gx-0 gx-md-4">
              <app-profile-summary class="d-block pt-3" [profileData]="profileData"
                                   [name]="profileService.currentEditorProfileName | async" [orcid]="orcid"
                                   [highlightOpenness]="emitHighlightOpenness | async"></app-profile-summary>
            </div>
          </ng-container>


          <ng-template #loadingTemplate>
            <mat-spinner class="mx-auto mt-3" [diameter]="80"></mat-spinner>
          </ng-template>


          <div class="col-12 col-md-5 col-lg-4 pt-3 px-0 ps-lg-1 pe-lg-3">
            <!-- Contact card -->
            <ng-container *ngIf="profileData">
              <aside>
                <app-contact-card i18n-label="@@contactInfo" label="Yhteystiedot" [data]="profileData"
                                  [isEditorView]="true"></app-contact-card>
              </aside>
            </ng-container>

            <!-- Collaboration -->
            <app-collaboration-card
                    *ngIf="profileData"
                    #collaborationComponentRef
                    i18n-label="@@cooperation"
                    label="Yhteistyö"
                    [data]="profileData"
                    [isEditorView]="true"
            ></app-collaboration-card>

            <!-- Open science settings -->
            <app-open-science-settings-card *ngIf="profileData" class='open-science-card'
                                            [highlightChecked]="highlightOpennessSub | async"
                                            (emitHighlightOpenness)="setHighlightOpennessState($event)"></app-open-science-settings-card>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<app-sticky-footer></app-sticky-footer>