<div style="background-color: orange; height: 100px; display: flex; justify-content: center; align-items: center">
  <app-search-bar2 [(value)]='keywords' (search)='searchKeywords(keywords)'></app-search-bar2>
</div>

<div style='max-width: 1440px; margin: 0 auto'>
  <!--<div>
    <div>Keywords: {{keywords}}</div>
    <div>Search Parameters: {{searchParams$ | async | json}}</div>
  </div>-->


  <!-- Tab-like buttons -->
  <div style='height: 80px; margin-top: 20px; display: flex'>
    <!-- 7x same width areas -->
    <!-- unselected ones have margin-top: 10px of their own and border-bottom -->
    <!-- selected tab has no margin and has all other borders than bottom -->

    <ng-container *ngFor='let tab of ["Julkaisut", "Tutkijat", "Hankkeet", "Aineistot", "Rahoitushaut", "Infrastruktuurit", "Organisaatio"]'>
      <!-- Mock the selected to be equal to "A" -->

      <ng-container *ngIf='tab === "Julkaisut"'>
        <div style='display: flex; justify-content: center; flex-grow: 1; align-items: center; height: 80px; border: 1px solid black; border-bottom: none; background-color: white'>
          {{tab}}
        </div>
      </ng-container>

      <ng-container *ngIf='tab !== "Julkaisut"'>
        <div style='display: flex; justify-content: center; flex-grow: 1; align-items: center; height: 70px; margin-top: 10px; border-bottom: 1px solid black; background-color: rgb(232, 232, 245)'>
          {{tab}}
        </div>
      </ng-container>
    </ng-container>
  </div>

  <div style='display: flex; align-items: center; justify-content: space-between; width: 100%'>
    <div>
      <h2>Julkaisut - {{total$ | async}}</h2>
    </div>

    <div style='height: 58px; padding: 16px'>
      Näytetään tulokset {{(page - 1) * size + 1}} - {{page * size}} / {{total$ | async}}

      <select [ngModel]='size' (ngModelChange)='setPageSize($event)'>
        <option [ngValue]='10'>10</option>
        <option [ngValue]='100'>100</option>
      </select>

      tulosta / sivu

      <a href='#'>Mitä julkaisutietoja palvelu sisältää?</a>
    </div>
  </div>

  <!-- TODO DELETE -->
  <!--<div>
    <button (click)='setPageSize(10)'>Näytä 10</button>
    <button (click)='setPageSize(100)'>Näytä 100</button>
  </div>-->

  <div style='display: flex'>
    <div style='background-color: rgb(232, 232, 245); padding: 16px'>
      <div style='width: 300px'>

        <!-- TODO DELETE OLD year filters -->
        <!--<div style='background-color: #e6f9ff; border-radius: 4px'>
          <ng-container *ngFor='let yearFilter of yearFilters$ | async | limit: 10'>
            <div style='display: flex; padding: 16px 12px; user-select: none; cursor: pointer' (click)='toggleParam("year", yearFilter.year)'>
              <div style='margin-right: 0.5rem'>
                <input type='checkbox' [ngModel]='yearFilter.enabled'>
              </div>

              <div style='display: flex; flex-grow: 1; justify-content: space-between'>
                <div>
                  {{yearFilter.year}}
                </div>

                <div>
                  ({{yearFilter.count}})
                </div>
              </div>

            </div>
          </ng-container>
        </div>-->

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <!-- year filter with filter-options -->
        <div>
          <app-collapsible label='Julkaisuvuosi'>
            <ng-container *ngFor='let yearFilter of yearFilters$ | async | limit: 10'>
              <app-filter-option [label]='yearFilter.year'
                                 [count]='yearFilter.count'
                                 [value]='yearFilter.enabled'
                                 (valueChange)='toggleParam("year", yearFilter.year)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>
        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <app-organization-filter [filterData]='organizationFilters$ | async' (selected)='toggleParam("organization", $event)'></app-organization-filter>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <!-- languageCodeNames debug -->
          <!--<div style='white-space: pre'>
            {{languageCodeNames$ | async | json}}
          </div>-->

          <app-collapsible label='Kieli'>
            <ng-container *ngFor='let languageCodeFilter of languageCodeFilters$ | async'>
              <app-filter-option [label]='languageCodeFilter.name'
                                 [count]='languageCodeFilter.count'
                                 [value]='languageCodeFilter.enabled'
                                 (valueChange)='toggleParam("language", languageCodeFilter.id)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>

        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <div style='white-space: pre'>

            <app-collapsible label='Publication Format'>
              <ng-container *ngFor='let publicationFormatFilter of publicationFormatFilters$ | async'>
                <app-filter-option [label]='publicationFormatFilter.name'
                                   [count]='publicationFormatFilter.count'
                                   [value]='publicationFormatFilter.enabled'
                                   (valueChange)='toggleParam("format", publicationFormatFilter.id)'>
                </app-filter-option>
              </ng-container>
            </app-collapsible>

          </div>
        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <app-collapsible label='Publication Audience'>
            <ng-container *ngFor='let publicationAudienceFilter of publicationAudienceFilters$ | async'>
              <app-filter-option [label]='publicationAudienceFilter.name'
                                 [count]='publicationAudienceFilter.count'
                                 [value]='publicationAudienceFilter.enabled'
                                 (valueChange)='toggleParam("audience", publicationAudienceFilter.id)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>
        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <app-collapsible label='Peer Reviewed'>
            <ng-container *ngFor='let peerReviewedFilter of peerReviewedFilters$ | async'>
              <app-filter-option [label]='peerReviewedFilter.name'
                                 [count]='peerReviewedFilter.count'
                                 [value]='peerReviewedFilter.enabled'
                                 (valueChange)='toggleParam("peerReviewed", peerReviewedFilter.id)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>
        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <app-collapsible label='Parent Publication Type'>
            <ng-container *ngFor='let parentPublicationTypeFilter of parentPublicationTypeFilters$ | async'>
              <app-filter-option [label]='parentPublicationTypeFilter.name'
                                 [count]='parentPublicationTypeFilter.count'
                                 [value]='parentPublicationTypeFilter.enabled'
                                 (valueChange)='toggleParam("parentPublicationType", parentPublicationTypeFilter.id)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>
        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <app-collapsible label='International Publication'>
            <ng-container *ngFor='let internationalPublicationFilter of internationalPublicationFilters$ | async'>
              <app-filter-option [label]='internationalPublicationFilter.name'
                                 [count]='internationalPublicationFilter.count'
                                 [value]='internationalPublicationFilter.enabled'
                                 (valueChange)='toggleParam("international", internationalPublicationFilter.id)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>
        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <app-collapsible label='Article Type'>
            <ng-container *ngFor='let articleTypeCodeFilter of articleTypeCodeFilters$ | async'>
              <app-filter-option [label]='articleTypeCodeFilter.name'
                                 [count]='articleTypeCodeFilter.count'
                                 [value]='articleTypeCodeFilter.enabled'
                                 (valueChange)='toggleParam("articleType", articleTypeCodeFilter.id)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>
        </div>

        <!-- TODO DELETE -->
        <div style='margin: 1rem'></div>

        <div>
          <app-collapsible label='Jufo'>
            <ng-container *ngFor='let jufoClassCodeFilter of jufoClassCodeFilters$ | async'>
              <app-filter-option [label]='jufoClassCodeFilter.id'
                                 [count]='jufoClassCodeFilter.count'
                                 [value]='jufoClassCodeFilter.enabled'
                                 (valueChange)='toggleParam("jufo", jufoClassCodeFilter.id)'>
              </app-filter-option>
            </ng-container>
          </app-collapsible>
        </div>
      </div>
    </div>

    <div style='max-width: 1550px; padding-left: 16px'>
      <div style='background-color: rgb(232, 232, 245); padding: 16px; border: 1px solid #4546b9; border-radius: 4px; margin-bottom: 2rem;'>

        <!-- TODO chips for filters and remove button -->
        <!-- year filters -->

        <ng-container *ngFor='let yearFilter of yearFilters$ | async'>
          <ng-container *ngIf='yearFilter.enabled'>
            <div style='display: flex; justify-content: center; align-items: center; margin: 5px; padding: 5px; border: 1px solid black; border-radius: 5px'>
              <div style='margin-right: 5px'>{{yearFilter.year}}</div>
              <button (click)='toggleParam("year", yearFilter.year)'>X</button>
            </div>
          </ng-container>
        </ng-container>

      </div>

      <table cdk-table [dataSource]="dataSource">
        <ng-container cdkColumnDef="publicationName">
          <cdk-header-cell cdk-header-cell *cdkHeaderCellDef>
            Julkaisun nimi
          </cdk-header-cell>

          <cdk-cell *cdkCellDef="let element">
            <div [innerHTML]='element.publicationName'></div>
          </cdk-cell>
        </ng-container>

        <ng-container cdkColumnDef="authorsText">
          <cdk-header-cell *cdkHeaderCellDef>
            Tekijät
          </cdk-header-cell>

          <cdk-cell *cdkCellDef="let element">
            <div [innerHTML]='element.authorsText'></div>
          </cdk-cell>
        </ng-container>

        <ng-container cdkColumnDef="publisherName">
          <cdk-header-cell *cdkHeaderCellDef>
            Julkaisukanava
          </cdk-header-cell>

          <cdk-cell *cdkCellDef="let element">
            <div [innerHTML]='element.publisherName'></div>
          </cdk-cell>
        </ng-container>

        <ng-container cdkColumnDef="publicationYear">
          <cdk-header-cell *cdkHeaderCellDef>
            Julkaisuvuosi
          </cdk-header-cell>

          <cdk-cell *cdkCellDef="let element">
            <div [innerHTML]='element.publicationYear'></div>
          </cdk-cell>
        </ng-container>

        <tr cdk-header-row *cdkHeaderRowDef="displayedColumns"></tr>
        <tr cdk-row *cdkRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <div>
        <app-pagination [page]='page' [pageSize]='size' [total]='total$ | async'></app-pagination>
      </div>
    </div>
  </div>
</div>
