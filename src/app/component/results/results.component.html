<!--  This file is part of the research.fi API service

 Copyright 2019 Ministry of Education and Culture, Finland

 :author: CSC - IT Center for Science Ltd., Espoo Finland servicedesk@csc.fi
 :license: MIT -->

<app-search-bar></app-search-bar>

<div class="container" style="margin-top:25px;">
    <div class="row">
        <div class="col col-2">
            <a class="breadcrumb" routerLink="/">< Takaisin etusivulle</a>
            <h3 style="color: #808080; padding-top: 55px;">SUODATA</h3>
            <mat-expansion-panel [expanded]="true" (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>JULKAISUVUOSI</strong>
                </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-radio-group aria-label="Select an option">
                    <mat-radio-button value="year">Vuosi</mat-radio-button>
                    <mat-radio-button value="between">Aikaväli</mat-radio-button>
                </mat-radio-group>
            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>SEKTORI</strong>
                </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-checkbox></mat-checkbox>
            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>TIETEENALA</strong>
                </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-checkbox></mat-checkbox>
            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>JULKAISUTYYPPI</strong>
                </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-checkbox></mat-checkbox>
            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>MAA</strong>
                </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-checkbox></mat-checkbox>
            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>KIELI</strong>
                </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-checkbox></mat-checkbox>
            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>AVOIN SAATAVUUS</strong>
                </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-checkbox></mat-checkbox>
            </mat-expansion-panel>

            <section class="" style="padding-top: 25px;">
                <span>Kansainvälinen yhteisjulkaisu</span>
                <mat-checkbox></mat-checkbox>
            </section>

        </div>

        <div class="col-10" *ngFor="let publication of responseData">
            <mat-tab-group>
                <mat-tab label="Julkaisut ({{publication.hits.total}})">
                        <h3 style="float:left; margin-top:10px;">Hakutulokset</h3>
                    <div class="spinner-center" *ngIf="undefined === responseData">
                        <mat-spinner [diameter]="80"></mat-spinner>
                    </div>
                    <div class="sort">
                        <span class="align-left" style="margin-right: 25px; text-transform: uppercase;">Järjestä</span>
                        <mat-form-field>
                            <select matNativeControl>
                              <option value="newest">Uusin ensin</option>
                              <option value="oldet">Vanhin ensin</option>
                            </select>
                        </mat-form-field>
                    </div>
                    <div *ngFor="let publication of responseData">
                    <table mat-table>
                        <tr class="header">
                            <th></th>
                            <th>Julkaisun nimi</th>
                            <th>Tekijät</th>
                            <th>Julkaisukanava</th>
                            <th>Vuosi</th>
                        </tr>
                        <tr class="expand" [attr.data-selected]="false" (click)="expandStatus[i]=!expandStatus[i]" 
                            [class.expand]="expandStatus[i]"  *ngFor="let x of publication.hits.hits; let i = index">
                            <td class="expand"><a class="arrow" [class.expand]="expandStatus[i]"></a></td>
                            <td style="min-width:400px;">{{x._source.doc.row.publicationName}}</td>
                            <td class="shorten">{{x._source.doc.row.authorsText}}</td>
                            <td class="shorten">{{x._source.doc.row.journalName}}</td>
                            <td>{{x._source.doc.row.reportingYear}}</td>
                        </tr>
                    </table>
                    </div>
                    <a class="pagination-link"  *ngIf="fromPage > 0" (click)="previousPage()">Edellinen sivu | </a>
                    <a class="pagination-link" (click)="nextPage()">Seuraava sivu</a>
                    <mat-paginator [length]="publication.hits.total"
                        [pageSize]="10"
                        (page)="pageEvent = $event">
                    </mat-paginator>

                </mat-tab>
                <mat-tab label="Tutkijat"> </mat-tab>
                <mat-tab label="Projektit"> </mat-tab>
                <mat-tab label="Organisaatiot"> </mat-tab>
            </mat-tab-group>
        </div>
    </div>
</div>
