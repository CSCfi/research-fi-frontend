<!--  This file is part of the research.fi API service
 Copyright 2019 Ministry of Education and Culture, Finland
 :author: CSC - IT Center for Science Ltd., Espoo Finland servicedesk@csc.fi
 :license: MIT -->

<nav id="tabs">
<div class="wrapper" *ngIf="allData; else noData" [tabindex]="isHomePage ? -1 : 0" (keyup)="isHomePage ? '' : navigate($event)">
    <div #scroll class="scroll" *ngFor="let counted of allData">
      <div class="edge" [ngStyle]="{'display': lastScrollLocation > 0 ? 'block' : 'none'}">
        <div class="grad grad-left"></div>
        <div class="arrow arrow-left d-none d-sm-block" (click)="scrollLeft()"><fa-icon [icon]="faArrowLeft"></fa-icon></div>
      </div>
      <div class="edge" [ngStyle]="{'display': offsetWidth + lastScrollLocation < scrollWidth ? 'block' : 'none'}">
        <div class="grad grad-right"></div>
        <div class="arrow arrow-right d-none d-sm-block" (click)="scrollRight()"><fa-icon [icon]="faArrowRight"></fa-icon></div>
      </div>
      <div *ngFor="let tab of tabData; let i = index;" class="bundler" [class.disabled]="tab.data.length === 0" [ngStyle]="homepageStyle" [class.active]="selectedTab === tab.link">
        <a *ngIf="tab.data.length > 0; else disabledTab" [id]="tab.link" [tabindex]="isHomePage ? 0 : -1" (click)="resetFocus(true); disableScroll(true)" routerLink="/results/{{tab.link}}/{{searchService.currentInput | async}}/"
          #tabList [queryParams]="queryParams[tab.link]">
          <div class="tab-icon" class="tab-icon {{tab.data}}" [ngStyle]="homepageIcons"><fa-icon [icon]="tab.icon"></fa-icon></div>
          <div *ngIf="locale === 'fi'" class="label text-center">{{tab.labelFi}}</div>
          <div *ngIf="locale === 'se'" class="label text-center">{{tab.labelSe}}</div>
          <div *ngIf="locale === 'en'" class="label text-center">{{tab.labelEn}}</div>
          <div class="numeric-box d-sm-block" [countUp]="tab.data ? counted.aggregations._index.buckets[tab.data].doc_count : 999" [options]="myOps">0</div> <!-- TODO: Remove the ternary operator when all data becomes available -->
        </a>
        <ng-template #disabledTab>
          <div class="tab-icon" class="tab-icon {{tab.data}}" [ngStyle]="homepageIcons"><fa-icon [icon]="tab.icon"></fa-icon></div>
          <div *ngIf="locale === 'fi'" class="label text-center">{{tab.labelFi}}</div>
          <div *ngIf="locale === 'se'" class="label text-center">{{tab.labelSe}}</div>
          <div *ngIf="locale === 'en'" class="label text-center">{{tab.labelEn}}</div>
          <div class="numeric-box d-sm-block">Tulossa</div>
        </ng-template>
      </div>
    </div>
  </div>
  <ng-template #noData>
    <div class="row justify-content-center">
      <div class="col" align="center" style="margin: 2rem 0;">
        <mat-spinner [diameter]="40"></mat-spinner>
        <h2 class="error" *ngIf="errorTimeout">Yhteysongelma. Dataa ei saatavilla.</h2>
      </div>
    </div>
  </ng-template>
</nav>